
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Applying Functions and Plotting in Pandas &#8212; Data Science using Python</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "github-org/github-repo");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "üí¨ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/DC-2.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Working with Multiple DataFrames" href="Merge%20and%20Concat%20Dataset.html" />
    <link rel="prev" title="Grouping and Pivoting" href="Pandas%20grouping%20and%20pivoting.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/DC-2.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Data Science using Python</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Data Science
  </a>
 </li>
</ul>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Python%20editor.html">
   Python Editor
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Programming using Python
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../01/Workflow_intro.html">
   1. Introduction to Python
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../01/workflow_1.html">
     Basic Python Data Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/workflow_2.html">
     Branching Programs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/workflow_3.html">
     Visualizing Branching Programs
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../02/Sequence%2C%20Loops%20and%20Methods.html">
   2. Sequence, Loops and Methods
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../02/String%20Methods.html">
     String Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/List%20and%20Tuples.html">
     List and Tuples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/Loops.html">
     Loops
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03/Dictionaries%20and%20Comprehensions.html">
   3. Dictionaries and Comprehensions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02/Exercise%2001.html">
   üìù Exercise 01
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02/Solutions%2001.html">
   üìÉ Solution for Exercise 01
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../03/Functions%20and%20Exceptions.html">
   4. Functions and Exceptions
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../03/Exceptions.html">
     Exceptions
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Data Wrangling using Python
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="NumPy.html">
   5. Introduction to Numpy
  </a>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="Pandas%20Intro.html">
   6. DataFrames in Python
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="Introduction%20to%20Pandas.html">
     Introduction to Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Pandas%20grouping%20and%20pivoting.html">
     Grouping and Pivoting
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Applying Functions and Plotting in Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Merge%20and%20Concat%20Dataset.html">
     Working with Multiple DataFrames
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../05/sql%20intro.html">
   7. Relational Databases and SQL
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../05/sql%20rdbms.html">
     The Relational Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/sql%20basics.html">
     SQL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/sql%20joins.html">
     SQL Joins
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../06/viz%20intro.html">
   8. Data Visualization
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../06/viz%20quantitative.html">
     Visualizing Quantitative Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/viz%20qualitative.html">
     Visualizing Qualitative Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/viz%20matplotlib.html">
     Customizing Plots using matplotlib
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Visit our <a href="https://github.com/MultiverseDF/book">repository</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/Chapters/04/Pandas apply strings and plotting.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/MultiverseDF/book/main?urlpath=tree/./Chapters/04/Pandas apply strings and plotting.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apply">
   Apply
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#string-manipulation">
   String Manipulation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping">
   Grouping
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting">
   Plotting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="applying-functions-and-plotting-in-pandas">
<h1>Applying Functions and Plotting in Pandas<a class="headerlink" href="#applying-functions-and-plotting-in-pandas" title="Permalink to this headline">¬∂</a></h1>
<hr style="height:1px;border:none;color:#666;background-color:#666;" />
<p>In this section, we will answer the question:</p>
<p><strong>Can we use the last letter of a name to predict the sex of the baby?</strong></p>
<p>Here‚Äôs the Baby Names dataset once again:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">baby</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;babynames.csv&#39;</span><span class="p">)</span>
<span class="n">baby</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># the .head() method outputs the first five rows of the DataFrame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Sex</th>
      <th>Count</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mary</td>
      <td>F</td>
      <td>9217</td>
      <td>1884</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Anna</td>
      <td>F</td>
      <td>3860</td>
      <td>1884</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Emma</td>
      <td>F</td>
      <td>2587</td>
      <td>1884</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Elizabeth</td>
      <td>F</td>
      <td>2549</td>
      <td>1884</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Minnie</td>
      <td>F</td>
      <td>2243</td>
      <td>1884</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Breaking the Problem Down</strong></p>
<p>Although there are many ways to see whether prediction is possible, we will use plotting in this section. We can decompose this question into two steps:</p>
<ol class="simple">
<li><p>Compute the last letter of each name.</p></li>
<li><p>Group by the last letter and sex, aggregating on Count.</p></li>
<li><p>Plot the counts for each sex and letter.</p></li>
</ol>
<div class="section" id="apply">
<h2>Apply<a class="headerlink" href="#apply" title="Permalink to this headline">¬∂</a></h2>
<hr>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> Series contain an <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> method that takes in a function and applies it to each value in the Series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="n">baby</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span>
<span class="n">names</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0          4
1          4
2          4
3          9
4          6
          ..
1891889    5
1891890    5
1891891    5
1891892    6
1891893    8
Name: Name, Length: 1891894, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>To extract the last letter of each name, we can define our own function to pass into <code class="docutils literal notranslate"><span class="pre">.apply()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">last_letter</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">string</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">names</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">last_letter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0          y
1          a
2          a
3          h
4          e
          ..
1891889    s
1891890    y
1891891    a
1891892    e
1891893    p
Name: Name, Length: 1891894, dtype: object
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="string-manipulation">
<h2>String Manipulation<a class="headerlink" href="#string-manipulation" title="Permalink to this headline">¬∂</a></h2>
<hr>
<p>Although <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> is flexible, it is often faster to use the built-in string manipulation functions in <code class="docutils literal notranslate"><span class="pre">pandas</span></code> when dealing with text data.</p>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> provides access to string manipulation functions using the <code class="docutils literal notranslate"><span class="pre">.str</span></code> attribute of Series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="n">baby</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span>
<span class="n">names</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0          4
1          4
2          4
3          9
4          6
          ..
1891889    5
1891890    5
1891891    5
1891892    6
1891893    8
Name: Name, Length: 1891894, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We can directly slice out the last letter of each name in a similar way.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0          y
1          a
2          a
3          h
4          e
          ..
1891889    s
1891890    y
1891891    a
1891892    e
1891893    p
Name: Name, Length: 1891894, dtype: object
</pre></div>
</div>
</div>
</div>
<p>We suggest looking at the docs for the full list of string methods (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/text.html">link</a>).</p>
<p>We can now add this column of last letters to our <code class="docutils literal notranslate"><span class="pre">baby</span></code> DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">baby</span><span class="p">[</span><span class="s1">&#39;Last&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">baby</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Sex</th>
      <th>Count</th>
      <th>Year</th>
      <th>Last</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mary</td>
      <td>F</td>
      <td>9217</td>
      <td>1884</td>
      <td>y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Anna</td>
      <td>F</td>
      <td>3860</td>
      <td>1884</td>
      <td>a</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Emma</td>
      <td>F</td>
      <td>2587</td>
      <td>1884</td>
      <td>a</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Elizabeth</td>
      <td>F</td>
      <td>2549</td>
      <td>1884</td>
      <td>h</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Minnie</td>
      <td>F</td>
      <td>2243</td>
      <td>1884</td>
      <td>e</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1891889</th>
      <td>Titus</td>
      <td>M</td>
      <td>5</td>
      <td>1883</td>
      <td>s</td>
    </tr>
    <tr>
      <th>1891890</th>
      <td>Toney</td>
      <td>M</td>
      <td>5</td>
      <td>1883</td>
      <td>y</td>
    </tr>
    <tr>
      <th>1891891</th>
      <td>Verna</td>
      <td>M</td>
      <td>5</td>
      <td>1883</td>
      <td>a</td>
    </tr>
    <tr>
      <th>1891892</th>
      <td>Winnie</td>
      <td>M</td>
      <td>5</td>
      <td>1883</td>
      <td>e</td>
    </tr>
    <tr>
      <th>1891893</th>
      <td>Winthrop</td>
      <td>M</td>
      <td>5</td>
      <td>1883</td>
      <td>p</td>
    </tr>
  </tbody>
</table>
<p>1891894 rows √ó 5 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="grouping">
<h2>Grouping<a class="headerlink" href="#grouping" title="Permalink to this headline">¬∂</a></h2>
<hr>
<p>To compute the sex distribution for each last letter, we need to group by both Last and Sex.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shorthand for baby.groupby([&#39;Last&#39;, &#39;Sex&#39;]).agg(np.sum)</span>
<span class="n">baby</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Last&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Count</th>
      <th>Year</th>
    </tr>
    <tr>
      <th>Last</th>
      <th>Sex</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>F</th>
      <td>58079486</td>
      <td>915565667</td>
    </tr>
    <tr>
      <th>M</th>
      <td>1931630</td>
      <td>53566324</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">b</th>
      <th>F</th>
      <td>17376</td>
      <td>1092953</td>
    </tr>
    <tr>
      <th>M</th>
      <td>1435939</td>
      <td>7658923</td>
    </tr>
    <tr>
      <th>c</th>
      <th>F</th>
      <td>30262</td>
      <td>1666288</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">Year</span></code> is also summed up since each non-grouped column is passed into the aggregation function. To avoid this, we can select out the desired columns before calling <code class="docutils literal notranslate"><span class="pre">.groupby()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># When lines get long, you can wrap the entire expression in parentheses</span>
<span class="c1"># and insert newlines before each method call</span>
<span class="n">letter_dist</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">baby</span><span class="p">[[</span><span class="s1">&#39;Last&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Last&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">letter_dist</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Count</th>
    </tr>
    <tr>
      <th>Last</th>
      <th>Sex</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>F</th>
      <td>58079486</td>
    </tr>
    <tr>
      <th>M</th>
      <td>1931630</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">b</th>
      <th>F</th>
      <td>17376</td>
    </tr>
    <tr>
      <th>M</th>
      <td>1435939</td>
    </tr>
    <tr>
      <th>c</th>
      <th>F</th>
      <td>30262</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="plotting">
<h2>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¬∂</a></h2>
<hr>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> provides built-in plotting functionality for most basic plots, including bar charts, histograms, line charts, and scatterplots. To make a plot from a DataFrame, use the <code class="docutils literal notranslate"><span class="pre">.plot</span></code> attribute:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We use the figsize option to make the plot larger</span>
<span class="n">letter_dist</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:ylabel=&#39;Last,Sex&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/Pandas apply strings and plotting_18_1.png" src="../../_images/Pandas apply strings and plotting_18_1.png" />
</div>
</div>
<p>Although this plot shows the distribution of letters and sexes, the male and female bars are difficult to tell apart. By looking at the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> docs on plotting (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/visualization.html">link</a>) we learn that <code class="docutils literal notranslate"><span class="pre">pandas</span></code> plots one group of bars for row column in the DataFrame, showing one differently colored bar for each column. This means that a pivoted version of the <code class="docutils literal notranslate"><span class="pre">letter_dist</span></code> table will have the right format.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">letter_pivot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">baby</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Last&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span>
<span class="p">)</span>
<span class="n">letter_pivot</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Sex</th>
      <th>F</th>
      <th>M</th>
    </tr>
    <tr>
      <th>Last</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>58079486</td>
      <td>1931630</td>
    </tr>
    <tr>
      <th>b</th>
      <td>17376</td>
      <td>1435939</td>
    </tr>
    <tr>
      <th>c</th>
      <td>30262</td>
      <td>1672407</td>
    </tr>
    <tr>
      <th>d</th>
      <td>754233</td>
      <td>16412640</td>
    </tr>
    <tr>
      <th>e</th>
      <td>37421616</td>
      <td>14730974</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">letter_pivot</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:ylabel=&#39;Last&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/Pandas apply strings and plotting_21_1.png" src="../../_images/Pandas apply strings and plotting_21_1.png" />
</div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">pandas</span></code> conveniently generates a legend for us as well. However, this is still difficult to interpret. We plot the counts for each letter and sex which causes some bars to appear very long and others to be almost invisible. We should instead plot the proportion of male and female babies within each last letter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_for_each_letter</span> <span class="o">=</span> <span class="n">letter_pivot</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">letter_pivot</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]</span>

<span class="n">letter_pivot</span><span class="p">[</span><span class="s1">&#39;F prop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">letter_pivot</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">total_for_each_letter</span>
<span class="n">letter_pivot</span><span class="p">[</span><span class="s1">&#39;M prop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">letter_pivot</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">total_for_each_letter</span>
<span class="n">letter_pivot</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Sex</th>
      <th>F</th>
      <th>M</th>
      <th>F prop</th>
      <th>M prop</th>
    </tr>
    <tr>
      <th>Last</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>58079486</td>
      <td>1931630</td>
      <td>0.967812</td>
      <td>0.032188</td>
    </tr>
    <tr>
      <th>b</th>
      <td>17376</td>
      <td>1435939</td>
      <td>0.011956</td>
      <td>0.988044</td>
    </tr>
    <tr>
      <th>c</th>
      <td>30262</td>
      <td>1672407</td>
      <td>0.017773</td>
      <td>0.982227</td>
    </tr>
    <tr>
      <th>d</th>
      <td>754233</td>
      <td>16412640</td>
      <td>0.043935</td>
      <td>0.956065</td>
    </tr>
    <tr>
      <th>e</th>
      <td>37421616</td>
      <td>14730974</td>
      <td>0.717541</td>
      <td>0.282459</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">letter_pivot</span><span class="p">[[</span><span class="s1">&#39;F prop&#39;</span><span class="p">,</span> <span class="s1">&#39;M prop&#39;</span><span class="p">]]</span>
 <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;M prop&#39;</span><span class="p">)</span> <span class="c1"># Sorting orders the plotted bars</span>
 <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:ylabel=&#39;Last&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/Pandas apply strings and plotting_24_1.png" src="../../_images/Pandas apply strings and plotting_24_1.png" />
</div>
</div>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¬∂</a></h2>
<hr>
<p>We can see that almost all first names that end in ‚Äòp‚Äô are male and names that end in ‚Äòa‚Äô are female! In general, the difference between bar lengths for many letters implies that we can often make a good guess to a person‚Äôs sex if we just know the last letter of their first name.</p>
<p>We‚Äôve learned to express the following operations in <code class="docutils literal notranslate"><span class="pre">pandas</span></code>:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Operation</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">pandas</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Applying a function elementwise</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">series.apply(func)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>String manipulation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">series.str.func()</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Plotting</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df.plot.func()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "MultiverseDF/book",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Chapters/04"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="Pandas%20grouping%20and%20pivoting.html" title="previous page">Grouping and Pivoting</a>
    <a class='right-next' id="next-link" href="Merge%20and%20Concat%20Dataset.html" title="next page">Working with Multiple DataFrames</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ashray Shetty<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>